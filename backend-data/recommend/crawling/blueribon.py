# Beautifulsoup
import requests, json
from bs4 import BeautifulSoup as bs

# 셀레니움 기본 설정
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options

# 크롬 드라이버 자동 업데이트
from webdriver_manager.chrome import ChromeDriverManager

# 셀레니움 select에 사용할 선언
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import time

# 브라우저 꺼짐 방지
chrome_options = Options()
chrome_options.add_experimental_option("detach", True)

# 불필요한 에러 메세지 없애기
chrome_options.add_experimental_option("excludeSwitches", ["enable-logging"])

# 크롬 드라이버 설치
service = Service(executable_path=ChromeDriverManager().install())
driver = webdriver.Chrome(service=service, options=chrome_options)

import pandas as pd
import csv

# driver.get("https://www.bluer.co.kr/search?tabMode=single&searchMode=ribbonType&location=서울특별시&ribbonType=&feature=")
# driver.implicitly_wait(10)

# restro_data_id_list = []
# last_point = driver.find_element(By.XPATH, "//*[@id='page-selection']/ul/li[11]").get_attribute("data-lp")

# while True:
#     restro_list = driver.find_elements(By.CSS_SELECTOR, "li.rl-col.restaurant-thumb-item")
#     for restro in restro_list:
#         restro_data_id = restro.get_attribute("data-id")
#         restro_data_id_list.append(restro_data_id)

#     button_list = driver.find_element(By.CSS_SELECTOR, "ul.pagination.bootpag").find_elements(By.TAG_NAME, "li")
#     n = len(button_list)

#     for i in range(n):
#         button = button_list[i]
#         if button.get_attribute("class") == 'active':
#             print(i)
#             print(button.get_attribute("class"))
#             point = button.get_attribute("data-lp")
#             try:
#                 click_point = driver.find_element(By.XPATH, f"//*[@id='page-selection']/ul/li[{i+2}]/a").click()
#             except:
#                 pass
#             break

#     time.sleep(1)

#     if last_point == point:
#         break

# print(restro_data_id_list)

##1. https://www.bluer.co.kr/search?tabMode=single&searchMode=ribbonType&ribbonType=&feature=
# https://www.bluer.co.kr/restaurants/28167?query=&foodType=&foodTypeDetail=&feature=&location=&locationDetail=&priceRange=&ribbonType=&recommended=false&isSearchName=false&searchMode=ribbonType&zone1=&zone2=&zone2Lat=&zone2Lng=
##3. https://www.bluer.co.kr/restaurants/28167

restro_data_id_list = ['28167', '1534', '30639', '28946', '1521', '198', '29567', '254', '26655', '3998', '3506', '29242', '4945', '29243', '343', '27144', '382', '401', '28236', '415', '4953', 
'31431', '6783', '28480', '4649', '537', '26944', '571', '28229', '29464', '31886', '4667', '26017', '28481', '29083', '28054', '859', '30341', '20038', '19650', '15931', '909', '31793', '9283', '26983', '29204', '31949', '6701', '28351', '20475', '4855', '41', '1000', '29206', '57', '12679', '5050', '31136', '6858', '29569', '4875', '97', '4658', '27562', '33205', '1542', '4670', '27849', '6896', '4747', '125', '1552', '31855', '32021', '25265', '30653', '29170', '4158', '29411', '4724', '172', '29544', '178', '9273', '28532', '7027', '29542', '30468', '9379', '32038', '1089', '212', '29012', '5722', '32069', '31146', '28387', '6704', '28169', '3648', '6438', '1015', '30176', '30029', '246', '33410', '30105', '13602', '29346', '27626', '27434', '27424', '27960', '31046', '6949', '29089', '28324', '4719', '29689', '1431', '6402', '28335', '12425', 
'5035', '28191', '29709', '30189', '1104', '305', '4902', '28281', '3544', '28190', '7794', '6890', '28144', '1392', '4963', '30777', '28256', '32142', '31482', '29892', '29251', '1401', '1587', '28584', '30027', '336', '30509', '31446', '338', '29734', '6364', '4382', '29427', '6971', '28237', '29130', '31586', '9164', '4785', '28955', '378', '28574', '388', '19639', '28528', '29210', '31295', '28546', '28515', '5865', '5185', '30123', '6789', '29178', '32220', '22364', '6710', '29871', '30336', '3824', '1051', '13483', '28257', '6876', '30425', '472', '31100', '29470', '1160', '28957', '498', '4692', '6458', '6705', '30071', '32062', '29916', '25575', '29452', '511', '4872', '30599', '18362', '30988', '28116', '28470', '530', '6030', '32477', '4856', '32033', '29339', '31137', '32059', '27536', '31049', '32250', '31252', '27541', '6357', '32014', '22725', '7011', '29052', '6869', '4861', '6465', '29057', '19804', '29016', '31231', '29476', '22368', '29988', '30675', '608', '28947', '31510', '30074', '22712', '28318', '3739', '636', '31484', '5750', '31050', '31668', '7173', '29045', '32706', '31121', '31334', '27539', '3686', '28254', '27344', '684', '9177', '27906', '1230', '31007', '29602', '29132', '29209', '31285', '30254', '707', '712', '28182', '7927', '7017', '29168', '4281', '28984', '32136', '29880', '30122', '514', '28504', '30496', '31069', 
'30188', '26954', '17500', '4626', '30987', '28531', '29827', '6818', '772', '1505', '28514', '28123', '29227', '29211', '1493', '33411', '813', '26966', '1284', '28479', '6964', '27113', '3978', '855', '31432', '28125', '31712', '25069', '871', '29835', '5640', '6899', '30459', '891', '12482', '28456', '6814', '28492', '29256', '5752', '31365', '6819', '31917', '30198', '6963', '33445', '914', '1345', '915', '5076', '4937', '22366', '931', '27255', '30072', '29212', '29471', '941', '942', '28471', '29186', '946', '950', '9433', '952', '954', '30879', '4652', '20987', '29466', '28958', '5205', '3805', '27853', '4800', '29600', '28245', '27549', '3770', '27756', '30143', '29779', 
'4247', '27630', '28566', '29430', '3889', '108', '28603', '27453', '30684', '5125', '23', '995', '29770', '8705', '25', '996', '1439', '6787', '79', '4926', '997', '7034', '32', '5782', '18337', '999', '30124', '23751', '29448', '30827', '9095', '3932', '30015', '29716', '43', '30656', '48', '1001', '52', '29764', '5592', '56', '31099', '29102', '65', '9122', '6881', '70', '26931', '26723', '32536', '75', '76', '4792', '5138', '33240', '28145', '29318', '82', '31148', '29434', '4869', '90', '29484', '30778', '6682', '5296', '3742', '30720', '133', '1533', '27572', '30410', '29028', '4686', '4900', '120', '20267', '32506', '3066', '128', '1414', '4882', '129', '131', '494', '134', '5931', '26596', '30262', '31133', '32623', '31064', '29147', '29803', '31535', '8965', '32127', '147', '5002', '28336', '160', '28414', '3963', '30473', '6408', '32821', '171', '1150', '28629', '32029', '29047', '179', '180', '4720', '183', '1078', '184', '31305', '186', '30595', '32690', '9142', '31646', '29935', '29428', '30565', '29909', '4196', '28973', '30476', '32759', '32939', '4093', '26801', '28279', '32434', '6928', '6137', '30606', '30732', '5689', '1086', '31956', '4632', '8489', '21407', '213', 
'3933', '28986', '3465', '6452', '31195', '32217', '6383', '12475', '18234', '24126', '230', '31961', '28564', '30734', '29609', '30451', '3464', '29420', '1419', '33446', 
'244', '245', '1420', '32917', '28358', '31267', '5092', '1507', '29549', '32331', '31109', '32342', '6268', '6967', '28249', '28152', '267', '30512', '31115', '33447', '30223', '32569', '32607', '31077', '30430', '31511', '29550', '280', '33173', '31151', '31153', '32268', '282', '16796', '31387', '9290', '31130', '287', '30251', '1571', '5223', '31222', '30634', '12991', '32028', '1103', '4745', '9071', '302', '1105', '4995', '1107', '28996', '18799', '27976', '32174', '29866', '308', '9118', '31680', '28455', '29451', '29259', '33388', '4625', '315', '316', '318', '30558', '1396', '29781', '30253', '30691', '30557', '30407', '29137', '1403', '6477', '30847', '29305', '31241', 
'3065', '32869', '32009', '9089', '31672', '1050', '342', '26428', '17751', '21885', '31138', '32208', '349', '27580', '31359', '9130', '31344', '33126', '27566', '29273', 
'364', '29490', '30440', '31808', '29410', '29465', '32597', '29479', '381', '3882', '384', '387', '1464', '1362', '32625', '3540', '13212', '402', '28115', '32047', '412', '5753', '27556', '28612', '1134', '8054', '7193', '419', '5607', '422', '4228', '423', '5215', '16950', '6407', '426', '30843', '31296', '9128', '27977', '28357', '27439', '31256', '30449', '30829', '437', '8465', '32073', '13329', '29498', '29303', '27746', '28945', '27503', '21510', '31951', '2838', '1448', '4703', '30350', '460', '12471', '3997', '3088', '29025', '6973', '8001', '470', '1152', '4767', '474', '478', '479', '483', '31134', '488', '7857', '490', '3845', '491', '31481', '3466', '25573', '29076', '23286', '16248', '30224', '1166', '504', '5905', '3826', '31144', '29100', '33111', '30532', '28600', '29134', '763', '31644', '30195', '27447', '512', '29703', '30659', '29867', '27656', '31035', '29179', '4091', '527', '24445', '3090', '1473', '1480', '6505', '19426', '31567', '27731', '28334', '27548', '32249', '29698', '29642', '29543', '17582', '33264', '28260', '32726', '31600', '1251', '31553', '28186', '29338', '1179', '30998', '28285', '31221', '19547', '32023', '30637', '32046', '5918', '32820', '3521', '32111', '4907', '6690', '7332', '31833', '563', '32527', '32099', '29715', '6416', '30586', '22475', '7059', '30636', '13013', '576', '5913', '32570', '32204', '31788', '30489', '31372', '18221', '12443', '6846', '31988', '7002', '1205', '6482', '4769', '591', '1567', '30578', '30424', '31246', '30394', '32696', '19805', '16222', '6118', '33210', '32018', '32019', '31839', '604', '32634', '32212', '606', '6957', '30482', '29014', '31341', '3835', '26930', '609', '31958', '6530', '32077', '33009', '27990', '27449', '29231', '615', '31579', '30560', '32071', '1411', '28520', '1215', '1216', '3900', '625', '31690', '29990', '629', '632', '30427', '5148', '32529', '634', '4783', '9065', '6849', '29229', '5926', '28379', '31039', '27437', '23549', '652', '655', '30085', '31396', '29157', '29306', '29481', '5064', '6462', '30108', '661', '662', '27860', '18601', '31467', '31292', '33351', '28544', '4697', '31155', '30638', '29831', '681', '32312', '682', '6377', '7275', '17884', '686', '3524', '31947', '687', '32480', '31899', '30056', '31986', '30171', '29182', '4768', '5804', '691', '692', '1437', '695', '30388', '26594', '13330', '32219', '32528', '1236', '31995', '6988', '3110', '28413', '21820', '1237', '1239', '30660', '30507', '711', '12989', '714', '6942', '279', '28487', '33391', '18090', '31152', '31070', '31545', '19491', '30992', '12441', '33156', '1250', '29175', '27567', '3454', '739', '6398', '31215', '5061', '3084', '5046', '3949', '30012', '18927', '29197', '4203', '764', '765', '12958', '32007', '29407', '29921', '3724', '7177', '6706', '30739', '7943', '12410', '5634', '28350', '773', '4793', '775', '29788', '1264', '779', '32717', '32709', '5635', '780', '781', '30563', 
'782', '29915', '1494', '6433', '1270', '798', '800', '1272', '6060', '802', '29131', '28175', '31499', '1449', '4996', '31098', '1276', '29041', '30260', '6513', '30705', 
'6394', '814', '30830', '815', '26434', '6399', '1268', '27643', '29839', '31147', '30209', '29813', '32097', '843', '846', '31610', '32720', '33452', '29011', '30480', '6380', '5128', '30345', '28562', '111', '32544', '112', '6415', '19620', '29922', '8713', '22131', '28156', '854', '31172', '31666', '32017', '31207', '31982', '23473', '28437', '6840', '32032', '29576', '32546', '30454', '30201', '30795', '29710', '31441', '31444', '29097', '30712', '29632', '30073', '1302', '880', '31230', '31521', '29782', '32758', '31015', '28255', '888', '32489', '893', '23577', '31490', '26788', '28552', '897', '31240', '30577', '30118', '29500', '31150', '1096', '31166', '1040', '31364', '10', '3617', '29347', '6686', '30319', '1568', '30957', '5687', '1316', '31544', '29356', '32162', '31918', '449', '32679', '31276', '30200', '6708', '31149', '30272', '31637', '31836', '938', '28321', '5816', '26745', '30771', '6379', '29202', '5937', '23821', '951', '6487', '30986', '1321', '13385', '3825', '5642', '33129', '957', '27553', 
'12638', '58', '29156', '4150', '31154', '1325', '1327', '1383', '22439', '975', '4913', '32013', '979', '31483', '8510', '32615', '30238', '31962', '984', '18633', '30334', '986', '425', '31576', '33212', '31202', '4668', '30516', '33451', '31617', '5646', '1338', '28197', '31744', '31991', '19699', '8484', '32746', '31747', '32659', '32701', '31500', '30098', '33426', '32016', '32420', '8303', '32638', '33432', '32977', '1064', '28486', '31594', '31990', '29894', '30497', '30724', '1068', '32027', '29837', '33121', '7621', '23384', '31026', '31460', '32076', '32652', '32227', '170', '31360', '33198', '32984', '31985', '32782', '32496', '24893', '32261', '33076', '32166', '31336', '32932', '29995', '31993', '1087', '5174', '32537', '33373', '30416', '33298', '29293', '29885', '232', '28575', '33367', '28262', '32630', '30737', '32452', '32975', '31031', '32641', '30439', '31963', '29927', '33413', '31914', '33028', '31186', '32830', '30679', '30145', '5149', '6885', '31225', '26595', '32281', '30022', '7945', '32653', '30165', '32599', '32333', '1405', '33193', '33067', '32761', '31306', '370', '28023', '30648', '19123', '30788', '32938', '32185', '32891', '28942', '33163', '408', '30432', '7978', '28920', '6409', '32704', '30531', '12909', '28949', '31735', '7179', '32087', '1144', '16000', '30205', '33200', '9270', '484', '20917', '8874', '9267', '33406', '29236', '30013', '19132', '33263', '16866', '30696', '9009', '30491', '1170', '33237', '21261', '33403', '31367', '31892', '29413', '1189', '32725', '31530', '32548', '4682', '33093', '5041', '32567', '33400', '32551', '30764', '32864', '8731', '33270', '32646', '22482', '30305', '32139', '600', '6891', '32120', '33091', '32950', '30301', '32619', '32180', '33035', '6804', '32972', '30860', '4782', '32650', '6368', '5619', '32538', '6445', '29459', '7102', '33424', '6581', '33054', '33102', '31804', '6914', '32616', '32606', '13461', '1228', '32326', '30172', '31383', '21437', '4669', '30304', '29810', '1261', '30839', '33105', '31725', '704', '3779', '31020', '6403', '4146', '29758', '32177', '31597', '32134', '1504', '29276', '23424', '29553', '6200', '29480', '26600', '6864', '30708', '32105', '30796', '30773', '30812', '33204', '1252', '32916', '32298', '27286', '734', '29135', '6212', '30556', '33416', '17670', '32262', '758', '30823', '32198', '33335', '27738', '32259', '27574', '32934', '29234', '18316', '783', '31758', '31954', '1273', '33278', '7940', '6780', '29348', '30300', '30697', '3980', '30594', '32149', '27512', '30362', '30677', '30390', '31348', '32925', '31607', '873', '31893', '28274', '32651', '30443', '31232', '22489', '9139', '33051', '30756', '33183', '31832', '31658', '22709', '33265', '32728', '30417', '33371', '30084', '32539', '31593', '5115', '31895', '31468', '32519', '33418', '32540', '32205', '22700', '32611', '4908', '32571', '956', '962', '31361', '29760', '32374', '13347', '31824', '3893', '32115', '30500', '12749', '25908', '33184', '32353', '32427', '33220', '32466', '33364', '32685', '32762', '32299', '33087', '33039', '32431', '32566', '32203', '33146', '32976', '32098', '32141', '32502', '32128', '32549', '32965', '32915', '33482', '33366', '32608', '32352', '33224', '33069', '33520', '32991', '32285', '32870', '32664', '33369', '33020', '33361', '33250', '32772', '33095', '32598', '32591', '32442', '32130', '32680', '33143', '32924', '32280', '32541', '32667', '32304', '32978', '33483', '33545', '33008', '33090', '33047', '32886', '33161', '32707', '33269', '33176', '33241', '33299', '33012', '33293', '32757', '33537', '32000', '33433', '33017', '32954', '33285', '32874', '32804', '33137', '33522', '33059', '32940', '32151', '32953', '33551', '33561', '33550', '32966', '33282', '32763', '32225', '32756', '32921', '32215', '33080', '32181', '33011', '33435', '33513', '33248', '32730', '33151', '32332', '33175', '33174', '32801', '32987', '33238', '31679', '33380', '33547', '32751', '33524', '33615', '33160', '32658', '33214', '32165', '33501', '33199', '33085', '33532', '32700', '33327', '33552', '32698', '33454', '33381', '33357', '33358', '33557', '33110', '33300', '32955', '32678', '32971', '32780', '32277', '32543', '33434', '33531', '32943', '33563', '32278', '33149', '33117', '32648', '32545', '33207', '33360', '33512', '33182', '33387', '33449', '32015', '32494', '32605', '33162', '33587', '33546', '33377', '32144', '33019', '33370', '33021', '32666', '32279', '32878', '33122', '32121', 
'33083', '32951', '33372', '32875', '32882', '32182', '33362', '32319', '32129', '33516', '32224', '32927', '32475', '32244', '33260', '32636', '33128', '32410', '33230', '33325', '32328', '32176', '33472', '32964', '32885', '32246', '33249', '32503', '32945', '32158', '32522', '32201', '33385', '32716', '32005', '32118', '33470', '33064', '33132', '33401', '33549', '32568', '33305', '32799', '32248', '32419', '33168', '32613', '32929', '33404', '33393', '32674', '32575', '33063', '33577', '33541', '33450', '33301', '32798', '33368', '33155', '33223', '33152', '29584', '29586', '29494', '32231', '30144', '31253', '30573', '14961', '32731', '32526', '32689', '31358', '8008', '1410', '9274', '29589', '4935', '29510', '31403', '12998', '30928', '29188', '5119', '8483', '13', '5143', '29265', '23182', '14845', '14156', '14158', '15459', '16625', '32988', '18220', '27803', '29006', '15333', '6423', '8583', '31498', '13327', '28286', '19085', '27292', '4959', '29520', '25365', '31837', '7089', '7091', '7090', '32092', '28975', '8963', '15758', '14964', '25896', '8170', '31019', '25442', '31913', '31578', '8511', '5204', '3801', '26833', '27147', '29257', '7777', '17091', '28040', '31952', '998', '21601', '5065', '17087', '15092', '28637', '25125', '29235', '24177', '32030', '26597', '21855', '6906', '39', '6059', '30717', '25121', '30462', '31912', '14174', '30804', '31401', '8512', '12701', '30268', '7196', '26553', '5596', '46', '49', '50', '9068', '29384', '31485', '30549', '7355', '30263', '27701', '12804', '8369', '25228', 
'55', '26947', '32053', '29984', '9078', '24460', '1002', '7952', '29387', '13021', '29906', '30718', '22381', '31067', '8734', '29122', '32487', '31507', '22442', '12990', '33034', '5940', '32699', '7904', '28954', '7225', '66', '7926', '30719', '30199', '31714', '21719', '28990', '12822', '29488', '16010', '31547', '31430', '15204', '22273', '30174', '31786', '33417', '77', '78', '9189', '19982', '3809', '32462', '7956', '13627', '8265', '12927', '7745', '29392', '22380', '26951', '1003', '9381', '27236', '29322', '32175', '85', '23222', '5860', '9439', '6884', '5227', '20378', '15796', '92', '30225', '1062', '31825', '12715', '28929', '19415', '14213', '23719', '27019', '31605', '25674', '29593', '29595', '29594', '6771', '29592', '7043', '6927', '30995', '13017', '3920', '29096', '31519', '33431', '102', '30033', '29288', '25413', '8796', '28459', '31496', '31357', '33429', '28263', '27575', '31552', '29219', '9066', '7816', '28588', '28447', '30325', '29631', '15937', '27633', '7288', '13480', '8697', '17988', '5137', '32206', '26297', '7369', '7367', '8700', '28046', '7938', '13393', '30508', '12967', '32488', '8269', '24024', '15077', '8549', '30338', '7137', '4126', '18827', '24201', '15815', '5655', '130', '14809', '3958', '9201', '15999', '8552', '13584', '7207', '12995', '13101', '8785', '1067', '16024', '30242', '30722', '4960', '24391', '31112', '30723', '32942', '29821', '32829', '12680', '31950', '7010', '27814', '21910', '29091', '9092', '140', '19975', '23092', '32024', '19960', '26358', '30725', '27062', 
'26421', '150', '29461', '30958', '14236', '8798', '20001', '16656', '24577', '31355', '3848', '29467', '31621', '29194', '8437', '13158', '158', '13349', '31088', '15532', '13259', '31979', '159', '16463', '25406', '15031', '15289', '18542', '31983', '31439', '32295', '12926', '12719', '7159', '30478', '14244', '27464', '22087', '30134', '14245', '5194', '7811', '27473', '6563', '26913', '22911', '32694', '13239', '7897', '30682', '8467', '30323', '33103', '27415', '9099', '30426', '4818', '20372', '7629', '7954', '29254', '30710', '1076', '12969', '16287', '7210', '4962', '21768', '30727', '8168', '4288', '22000', '9409', '177', '23462', '19122', '5669', '15264', '15940', '15338', '32168', '8166', '32748', '26540', '12678', '12559', '25554', '32026', '20019', '7802', '31427', '32552', '7016', '5127', '14064', '189', '12523', '21818', '5306', '9374', '32588', '27396', '31745', '30428', '24099', '28743', '32385', '5878', '8384', '30562', '5810', '17861', '12480', '30190', '31068', '6673', '29000', '31541', '8474', '31546', '5097', '27226', '8779', '31333', '32828', '5815', '30728', '21622', '30649', '4758', '29502', '16285', '29059', '29859', '30729', '32898', '29858', '24348', '29337', '14858', '32291', '33344', '1083', '8176', '9163', '32257', '20569', '12961', '28628', '16323', '5708', '22172', '23378', '199', '6070', '30730', '30993', '25300', '27700', '29169', '8844', '13389', '30731', '32693', '29887', '31041', '6045', '24354', '16261', '200', '30504', '27711', '6369', '18051', '1011', '19041', '31588', '30202', '30203', '8646', '8723', '25678', '8969', '28567', '8727', '7942', '30236', '6501', '30322', '33113', '32081', '7306', '206', '8521', '7315', '7316', '18915', '13250', '207', '1418', '7905', '1573', '8800', '15197', '2797', '30107', '28327', '211', '3393', '26757', '32339', '27531', '214', '6436', '7734', '7736', '15315', '8490', '29798', '6486', '19237', '23928', '31992', '4108', '8558', '32025', '7910', '31879', '31191', '8665', '3658', '32010', '223', '8777', '6451', '30652', '27782', '29019', '30452', '6544', '29604', '31623', '31371', '226', '5201', '7212', '25741', '3913', '32192', '32222', '30661', '31798', '31797', '32755', '30210', '231', '8877', '7890', '8590', '31859', '29255', '21106', '12811', '30990', '7061', '27865', '28596', '28293', '30735', '33026', '256', '29105', '9375', '30646', '32723', '27230', '31294', '30046', '25583', '22369', '32719', '28548', '28132', '3867', '4740', '30698', '32070', '15373', '31312', '259', '7217', '27379', '26804', '29808', '6417', '31203', '29377', '28277', '30738', '21821', '4721', '9170', '31110', '31193', '30335', '8591', '9132', '27535', '266', '31811', '32660', '33018', '30490', '27825', '25412', '27892', '22003', '31243', '33419', '32643', '29563', '24981', '14143', '7319', '26790', '29696', '27683', '23259', '29608', '31528', '30706', '26653', '31187', '29113', '31898', '31880', '32733', '5849', '28443', '32992', '31377', '7646', '12599', '27559', '30457', '31443', '6904', '32931', '7552', '32307', '30881', '13281', '7219', '32379', '32432', '13484', '24793', '28370', '18729', '32067', '23123', '31945', '28359', '8672', '30243', '28314', '7109', '7110', '8268', '1100', '32498', '9181', '29791', '30644', '5695', '30474', '22370', '30131', '30258', '4204', '14063', '3714', '4718', '29285', '4933', '27622', '14307', '296', '15643', '297', '4880', '6855', '28346', '4127', '25772', '9069', '7320', '13282', '301', 
'3182', '13104', '14024', '6583', '8491', '18955', '304', '19437', '4992', '25572', '15313', '15479', '15531', '30218', '3570', '15235', '21897', '15841', '15296', '14313', '8406', '8737', '25335', '1106', '29136', '6633', '29396', '5743', '1109', '29109', '5100', '29120', '917', '31888', '32947', '7879', '8592', '28569', '31477', '26654', '5960', '7719', '7720', '31352', '8327', '33389', '23277', '17793', '13864', '22133', '641', '23426', '31580', '7032', '1391', '12808', '15101', '31301', '4928', '18989', '32274', '5144', '4990', '27347', '13161', '12386', '31774', '20054', '6916', '31405', '25277', '31800', '29290', '13386', '15415', '27670', '25381', '28195', '31532', '21046', '30127', '1402', '31662', '15733', '7916', '9264', '1406', '8803', '8804', '33423', '8805', '16808', '23095', '25923', '32048', '5029', '20549', '7667', '12419', '6941', 
'31822', '29598', '30867', '8476', '16299', '5056', '26943', '4309', '32229', '3993', '32012', '14329', '14331', '29317', '27673', '28010', '30897', '21717', '16569', '14079', '31835', '27304', '33167', '13216', '12861', '8790', '1120', '27296', '20433', '9004', '33464', '31584', '18829', '29773', '13353', '12412', '29272', '32306', '29746', 
'30252', '6926', '32318', '29744', '29119', '30273', '3396', '3475', '1122', '18321', '356', '33488', '28463', '31373', '31374', '31905', '31987', '30274', '359', '32289', 
'28205', '29056', '27105', '32581', '28550', '33414', '27918', '31082', '30235', '7228', '26761', '32628', '5286', '16387', '28315', '19694', '15953', '15574', '17465', '366', '8593', '30204', '22948', '4922', '27605', '30329', '31188', '3410', '25872', '30535', '368', '30313', '29583', '8806', '5703', '13340', '25553', '30277', '13352', '12411', '3970', '6943', '28461', '29873', '12919', '8309', '28041', '29733', '28541', '29732', '24270', '27780', '8417', '29647', '29511', '17116', '15857', '5605', '30343', '16251', '30339', '383', '19882', '15105', '385', '13005', '32054', '16949', '33556', '6821', '29745', '5095', '18230', '23430', '7044', '6604', '391', '31869', '33281', '32793', '26738', '21700', '30752', '31472', '32232', '22361', '21817', '31288', '31740', '4853', '7234', '8774', '7238', '7236', '22781', '22481', '9179', '29195', '12945', '27390', '27308', '20446', '8345', '8809', '32774', '32775', '32233', '31700', '29769', '1133', '15504', '22017', '8526', '31643', '31948', '16439', '32237', '32138', '3108', '9088', '7327', '28468', '31887', '5072', '1135', '29800', '23230', '16303', '13248', '5656', '3787', '12630', '12629', '7545', '12628', '6502', '29704', '33436', '420', 
'19969', '421', '26717', '7923', '6933', '22373', '19866', '26781', '6469', '7984', '424', '5166', '24383', '29274', '9113', '29840', '29763', '6503', '15153', '8580', '29275', '24911', '29241', '19619', '28919', '28485', '14918', '18038', '29101', '29352', '8155', '4886', '5253', '9155', '31925', '31549', '9044', '29020', '31254', '9404', '22056', '33521', '28278', '5835', '30662', '5745', '17889', '32148', '26758', '27189', '32090', '31108', '30337', '30340', '32074', '30832', '27384', '32368', '32880', '4286', '7593', '7594', '12635', '12637', '435', '32083', '32155', '28952', '31250', '31407', '33485', '32122', '29945', '27362', '6376', '30371', '22485', '31169', '32637', '31651', '24308', '5797', '30742', '31881', '25771', '22371', '32109', '29358', '31310', '31503', '21825', '31168', '33422', '12577', '447', '7829', '1141', '7328', '27758', '31542', '22359', '30869', '1143', '26373', '28342', '7053', '18573', '12565', '16478', '5034', '18588', '7245', '6570', '32695', '29261', '4991', '8595', '31354', '6489', '30349', '13009', '31476', '15712', '14393', '3635', '7804', '15136', '14396', '7851', '28122', '25106', '14400', '6497', '32956', '8061', '28944', '29309', '30237', '23558', '28987', '5848', '5288', '32381', '9085', '19813', '23824', '26987', '6397', '6925', '13265', '9093', '33415', '15360', '8742', '9110', '471', '9111', '14120', '6410', '13936', '9060', '30152', '8674', '7896', '476', '4801', '4994', '20061', '15726', '1153', '9104', '16571', '7331', '14407', '1154', '16466', '29863', '28431', '30849', '17911', '33517', '12986', '3934', '26826', '31540', '9461', '19390', '12933', '29144', '29162', '21996', '1519', '14414', '3856', '5746', '33329', '14417', '3947', '19737', '28582', '24086', '26563', '3722', '23351', '489', '8815', '1162', '7915', '181', '32189', '33538', '13015', '14419', '12999', '1164', '21307', '15167', '19299', '12963', '33180', '5173', '17370', '13368', '19430', '1165', '33407', '26271', '1517', '31937', '3453', '28643', '7622', '28644', '3898', '503', '32749', '30207', '9081', '31502', '29117', '23352', '26168', '33049', '13322', '30467', '27455', '3450', '31739', '9380', '30351', '1536', '28151', '12996', '33539', '18618', '33555', '22015', '14818', '14429', 
'5612', '5613', '29173', '30494', '16539', '7842', '1426', '5032', '26752', '31353', '30208', '4993', '9103', '13193', '25536', '9077', '7886', '509', '13974', '8651', '33511', '30245', '15756', '4048', '26316', '29017', '28238', '29786', '17471', '28620', '17843', '17922', '19734', '16250', '4192', '515', '513', '21112', '8296', '20241', '8600', '4820', '29418', '24275', '7856', '3917', '3741', '517', '518', '29262', '3987', '520', '32768', '521', '27609', '3967', '28950', '14439', '29450', '523', '524', '26016', '23576', '5005', '14440', '14441', '15345', '30997', '26893', '31582', '29903', '14444', '31946', '9010', '3105', '32982', '8601', '30050', '528', '30023', '33480', '20431', '14077', '15915', '30552', '27819', '32296', '19692', '1173', '30267', '12867', '5283', '23226', '30475', '23563', '31565', '26652', '6625', '3828', '29621', '29620', '3849', '19808', '31340', '9171', '24593', '532', '29335', '1544', '31871', '14449', '31030', '33055', '32108', '30324', '5948', '31495', '32676', '31486', '29606', '33257', '31453', '31557', '30994', '4647', '29893', '32064', '29738', '26320', '31955', '31029', '31554', '31556', '30255', '28978', '28465', '31331', '30409', '28419', '29904', '32380', '31802', '540', '32712', '6902', '28215', '29128', '26727', '30051', '31300', '4735', '32903', '26645', '28618', '8649', '4842', '7647', '32411', '33390', '14859', '6471', '32521', '27802', '27725', '31302', '546', '547', '8598', '7806', '7843', '30685', '3728', '26859', '30456', '31713', '32661', '8529', '7253', '3896', '27309', '8685', '29258', '29455', '7876', '19280', '23149', '12854', '1518', '28242', '32056', '28989', '24842', '7960', '8843', '7909', '4243', '1428', '32282', '556', '15717', '4205', '5250', '13164', '32082', '12856', '8163', '1471', '18324', '27175', '33061', '22047', '31539', '32196', '7747', '7803', '31438', '32476', '12951', '15550', '26623', '29215', '28201', '8693', '33382', '13159', '7025', '29099', '30515', '31784', '29342', '25698', '14428', '1186', '27587', '25881', '31916', '13441', '28021', '30066', '15184', '19260', '8797', '9378', '33118', '27510', '8440', '33605', '3684', '6728', '24351', '27237', '32601', '8686', '31789', '8447', '29944', '22794', '28273', '5699', '32644', '18655', '8833', '9053', '12916', '30464', '6144', '8683', '7846', '14488', '3777', '29218', '7930', '28538', '30758', '588', '14490', '31102', '31669', '29221', '6573', '15321', '29701', '12682', '1161', '32877', '31033', '30740', '33065', '6727', '30321', '3857', '31904', '29702', '28444', '28488', '13313', '32620', '30280', '7258', '5749', '30065', '32008', '23867', '8396', '16228', '8853', '22630', '5195', '32263', '9365', '29159', '15741', '26637', '25768', '27165', '29828', '31423', '21823', '30038', '30039', '26613', '17580', '26870', '27719', '32855', '8478', '15175', '33070', '31404', '31391', '31392', '6526', '7830', '24375', '7807', '15982', '21613', '32504', '32505', '611', '24278', '24425', '4224', '1212', '30822', '28997', '6889', '16252', '32011', '30256', '20243', '32163', '32207', '29023', '29926', '33209', '23260', '29294', '32718', '29284', '7787', '31529', '8169', '23436', '22756', '30070', '1447', '1217', '15543', '24377', '17314', '5172', '7580', '29761', '31921', '29370', '28631', '7957', '30030', '32288', '21569', '8605', '32633', '14142', '626', '27702', '32595', '8174', '627', '628', '8818', '33116', '32883', '32881', '4810', '6405', '633', '8819', '24499', '1220', '14527', '15035', '7860', '8164', '24424', '3839', '7919', '7944', '635', '7001', '6832', '14528', '15028', '3702', '15163', '14531', '8424', '640', '7784', '642', '6453', '22521', '13146', '13147', '7914', '6035', '13326', '4122', '8179', '30019', '26246', '9123', '27751', '16315', '24984', '26701', '12828', '7380', '26385', '28171', '32078', '8820', '3964', '31562', '32832', '29321', '16508', '16438', '28441', '30031', '13220', '20440', '31598', '654', '7888', '31289', '31885', '8821', '7852', '6029', '7115', '15757', '657', '658', '29525', '32006', '27372', '32079', '27650', '8167', '31960', '31765', '660', '6270', '28153', '4834', '31283', '21490', '9360', '31356', '31902', '32214', '31321', '30326', '32941', '8609', '22735', '23104', '7337', '4946', '13391', '12979', '33543', '670', '33201', '29104', '7392', '3522', '16009', '31944', 
'5067', '26104', '27407', '26861', '23389', '7889', '23580', '1225', '1226', '7338', '6371', '9285', '31603', '676', '19448', '30010', '19250', '677', '29572', '679', '13255', '7274', '4193', '31964', '33003', '30180', '19564', '29938', '14555', '8286', '15265', '15199', '5089', '32617', '33363', '29055', '30246', '31274', '3995', '8666', '9186', '30024', '30412', '3767', '15135', '29820', '32236', '26090', '12962', '8667', '689', '9039', '17579', '26169', '32113', '5621', '13472', '31167', '15032', '13222', '6539', '12874', '31834', '7339', '9097', '24983', '15845', '1232', '25372', '26636', '33544', '9067', '15062', '8469', '20483', '7895', '1233', '8178', '1136', '25537', '8764', '18256', '19821', '7891', '8532', '19388', '12810', '697', '7810', '7837', '20856', '18656', '29884', '32218', '700', '28104', '29875', '3800', '29381', '30385', '32063', '702', '32284', '8435', '32450', '28831', '1235', '15766', '23504', '13792', '18180', '31091', '27815', '29111', '9084', '9107', '30075', '31024', '7630', '16503', '32045', '25298', '32711', '12566', '28580', '31324', '31323', '27341', '27342', '31941', '23464', '24672', '15584', '7907', '33616', '32665', '13166', '7341', '31998', '32895', '7082', '23410', '13565', '32188', '30257', '29473', '18306', '29486', '24455', '25301', '31299', '24649', '30711', '24070', '5203', '21961', '5665', '8655', '19432', '31688', '32805', '3487', '1242', '15380', '7928', '33058', '1243', '30798', '33392', '22986', '30048', '33495', '33496', '32210', '3948', '30265', '31638', '33558', '29519', '29518', '31165', '9419', '30493', '32525', '33092', '717', '15206', '1246', '7836', '6610', '31719', '12857', '5732', '29456', '27720', '32935', '1247', '32153', '7858', '22367', '1248', '7343', '28636', '30991', '32574', '23117', '8073', '31659', '8291', '19086', '31284', '4144', '724', '4088', '7832', '32119', '14582', '8614', '8616', '30241', '16092', '19811', '19934', '33233', '33236', '33231', '33234', '33232', '33494', '31933', '31780', '32491', '30774', '18224', '5863', '4056', '31575', '31275', '15051', '13016', '30316', '25857', '6525', '12468', '21514', '32190', '22379', '29263', '29648', '3944', '7906', '22691', '9191', '28967', '30282', '29087', '736', '3973', '21497', '33375', '738', '8533', '29861', '26775', '13334', '8534', '13335', '16815', '3763', '13012', '9288', '7877', '22980', '746', '9083', '15037', '12912', '1255', '5629', '747', '14612', '18534', '29107', '33271', '6716', '15161', '13408', '1256', '29960', '13941', '5008', '23438', '754', '5660', '30709', '1257', '13354', '756', '8284', '17172', '18880', '29037', '5630', '17979', '28154', '12413', '21478', '14620', '13292', '30284', '26718', '28221', '21094', '14970', '32614', '30310', '7564', '31695', '13168', 
'33412', '5632', '27894', '31462', '14028', '8678', '28001', '15211', '16388', '31781', '26249', '30824', '22903', '13020', '8172', '20479', '18906', '5633', '8503', '15185', '29081', '16404', '29931', '3821', '24848', '13011', '29230', '1433', '31266', '30320', '32922', '7152', '33288', '13178', '19682', '8317', '15165', '5871', '28165', '7893', '1354', '15181', '33044', '14635', '8852', '1580', '32159', '4932', '32094', '4830', '27400', '15387', '21701', '7037', '32095', '6644', '7970', '7285', '1262', '774', '17035', '16304', '30173', '13576', '7672', '8570', '32031', '26599', '29819', '23578', '776', '7286', '22732', '15045', '4843', '12561', '28002', '32859', '3427', '32710', '17668', '31337', '31727', '6824', '27623', '785', '7057', '18423', '28333', '1269', '7361', '31298', '33099', '6032', '16207', '8657', '19728', '797', '19211', '15672', 
'7908', '31686', '20563', '32647', '12567', '26554', '8405', '29308', '7818', '31028', '28962', '8625', '4916', '12580', '13203', '29799', '9062', '1063', '27569', '32396', '5196', '808', '30574', '9198', '17874', '31184', '5657', '1559', '3840', '810', '31385', '31386', '812', '18648', '13717', '21621', '12921', '15850', '1279', '29886', '7839', '6496', '5917', '9199', '19183', '33425', '13328', '1280', '15630', '29983', '6968', '12868', '8627', '31089', '13190', '3971', '1281', '32451', '29883', '5178', '8573', '5637', '3725', '9266', '816', '30461', '3962', '903', '817', '8540', '16106', '29507', '4242', '819', '28454', '23446', '18010', '32364', '27534', '29060', '13479', '8628', '29801', '30859', '8574', '582', '33177', '30567', '33540', '31782', '27459', '32080', '30097', '32156', '30247', '28462', '32124', '31629', '32486', '31585', '18326', '33430', '29874', '31812', '27336', '16957', '29961', '27081', '8325', '32186', '31173', '8752', '1497', '27487', '19971', '21287', '26194', '31681', '29977', '29049', '31790', '30372', '3915', '29378', '32754', '6995', '32267', '31143', '8635', '30087', '21770', '8453', '29501', '9382', '32721', '27089', '31378', '7714', '33197', '12942', '29524', '32313', '23262', '33607', '29512', '8471', '8472', '31543', '33609', '7498', '3424', '32370', '28991', '28992', '8641', '22528', '25136', '29160', '31996', '23474', '26968', '28057', '31984', '5696', '13156', '32515', '26903', '22897', '26895', '30950', '3395', '29771', '26251', '28338', '31315', '12873', '32123', '32137', '31508', '13131', '12880', '7168', '30042', '27862', '27651', '30055', '29260', '6628', '3762', '25788', '18599', '32624', '28638', '12710', '4919', '1546', '26659', '12870', '22505', '28009', '33355', '32323', '30609', '1430', '32906', '3568', '12782', '24979', '836', '29765', '30477', '30554', '31959', '31506', '1300', '4799', '12399', '28624', '1301', '29554', '31210', '26872', '30331', '31817', '3519', '1359', '7291', '27164', '29291', '31493', '24919', '21918', '13338', '32178', '30429', '32172', '7855', '29787', '174', '30701', '19807', '8630', '15341', '8009', '9090', '4634', '26800', '29469', '32049', '16922', '28308', '28560', '29514', '29044', '31555', '16226', '31550', '13148', 
'7295', '19725', '30713', '31126', '889', '28464', '25844', '17367', '18176', '6866', '26406', '31978', '31071', '293', '19453', '30930', '14710', '22168', '8720', '8631', 
'210', '31470', '6722', '31400', '31309', '6557', '29319', '31731', '7349', '24633', '26753', '898', '15639', '9313', '19375', '29331', '5155', '31989', '32796', '21849', '13567', '19637', '6467', '7308', '8541', '19396', '33581', '32255', '5285', '31757', '30400', '5930', '28573', '5780', '33619', '29565', '25756', '1311', '5872', '28965', '29027', '33487', '27817', '5304', '9101', '33420', '1315', '7029', '13208', '6156', '916', '23156', '29264', '31910', '28008', '6484', '23856', '29357', '32055', '31940', '23479', '24726', '4804', '14729', '32193', '28096', '27488', '28959', '7660', '30035', '31783', '27753', '8633', '924', '8735', '8507', '926', '19515', '17028', '485', '19941', '6956', '21019', '28222', '31857', '14736', '17796', '6883', '27312', '31196', '29082', '29086', '31534', '29066', '32593', '29343', '7901', '8636', '31807', '9359', '31118', '28529', '28303', '6817', '940', '23076', '26093', '1378', '3894', '30460', '24896', '23258', '30759', '4775', '27806', '943', '15785', '28252', '20143', '21697', '12632', '3969', '17591', '5183', '26988', '27910', '18830', '24598', '18540', '12971', '18269', '23863', '19395', '15228', '21816', '13321', '31197', '4690', '29205', '16447', '3847', '26806', '6494', '21498', '28619', '33144', '18384', '12928', '29165', '14823', '12922', '8739', '5068', '13351', '21718', '8480', '14755', '24026', '4967', '7833', '31678', '33222', '6116', '8831', '9054', '3902', '31204', '23455', '9079', '3228', '16474', '3190', '29225', '7612', '7611', '8868', '31604', '4750', '7467', '8637', 
'8858', '8722', '4672', '8834', '7838', '13392', '30550', '26176', '1438', '9086', '3968', '30206', '7861', '5159', '8836', '21509', '33074', '29802', '29822', '29637', '18310', '30170', '4866', '13735', '963', '966', '20131', '7052', '23785', '8837', '7847', '27781', '26143', '15256', '6974', '17822', '968', '8694', '15277', '18140', '33562', '17211', '969', '5093', '3189', '15505', '7949', '9055', '13373', '972', '973', '974', '14133', '30264', '18268', '30248', '19806', '26716', '30688', '978', '7824', '8302', '29193', '19446', '19075', '17795', '26475', '13145', '9109', '7924', '9080', '8875', '30231', '14784', '8839', '7973', '6668', '28512', '8840', '13006', '32294', '31001', '3355', '23405', '19875', '29516', '3895', '29772', '30239', '27194', '33131', '29939', '1331', '25689', '28309', '28299', '12929', '23383', '23445', '29833', '29151', '5794', '7937', '28248', '7191', '1472', '23486', '22757', '3485', '13007', '18165', '7936', '24785', '32655', '30040', '5644', '28469', '13374', '29140', '29142', '31229', 
'15064', '23820', '19433', '7868', '18103', '5120', '1335', '29836', '21691', '9064', '1253', '19454', '990', '32387', '29371', '22375', '12562', '7614', '12658', '30049', 
'23452', '28445', '15273', '29022', '8561', '19584', '4899', '4951', '19698', '7950', '19739', '3899', '29705', '26902', '28296', '32020']

# #1주소에서 data-id 값을 추출해서 리스트화 하고 #3에 값을 넣어가면서 원하는 데이터 추출하는 과정
name = []
# hours = []
# menu = []
menu1 = []
menu2 = []
tag = []
address = []
number = []
thumbnail = []
location_x = []
location_y = []
resto_age = []
sectors = []

for restro_code in restro_data_id_list:
    blue_url = f"https://www.bluer.co.kr/restaurants/{restro_code}"
    page = requests.get(blue_url)
    soup = bs(page.text, "lxml")

    restro_sectors = soup.find('ol', attrs={"class": "foodtype"}).find('li').get_text()
    restro_name = soup.find('div', attrs={"class": "header-title"}).find('h1')
    restro_name.find('small').decompose()
    restro_name = restro_name.get_text()
    try:
        restro_number = soup.find('dl', attrs={"class": "dl-horizontal"}).find('a', attrs={"class": "link"}).get_text()
    except:
        restro_number = ''
    try:
        restro_address = soup.find('dl', attrs={"class": "dl-horizontal"}).findAll('dd')[1].get_text()
    except:
        retsro_address = ''
    restro_tag_key = soup.find('div', attrs={"class": "col-md-6 padding-lg-left border-left-lg"}).findAll('dt')
    restro_tag_value = soup.find('div', attrs={"class": "col-md-6 padding-lg-left border-left-lg"}).findAll('dd')
    restro_tag = {}
    restro_menu = soup.findAll('div', attrs={"class": "col-md-6 border-right-lg"})[1].find('dd').get_text()
    menu_list = restro_menu.split(',')
    try:
        restro_menu1 = menu_list[0].split('(')[0].strip()
        
    except:
        restro_menu1 = ''
    
    try:
        restro_menu2 = menu_list[1].split('(')[0].strip()
    except:
        restro_menu2 = ''

    def get_location(address):
        url = 'https://dapi.kakao.com/v2/local/search/address.json?query=' + address
        # 'KaKaoAK '는 그대로 두시고 개인키만 지우고 입력해 주세요.
        # ex) KakaoAK 6af8d4826f0e56c54bc794fa8a294
        headers = {"Authorization": "KakaoAK dca00a6145957259d9c0b9b788ecb425"}
        api_json = json.loads(str(requests.get(url,headers=headers).text))
        try:
            address = api_json['documents'][0]['address']
            crd = {"lat": str(address['y']), "lng": str(address['x'])}
        except:
            crd = {"lat": 'not found', "lng": 'not found'}
        return crd

    crd = get_location(restro_address)

    restro_location_y = crd["lat"]
    restro_location_x = crd["lng"]


    for i in range(len(restro_tag_key)):
        key = restro_tag_key[i].get_text()
        value = restro_tag_value[i].get_text().replace(' ', '').replace('\xa0\n', '').replace('\n', '')
        restro_tag[key] = value
    try:
        restro_age = restro_tag['개업일(연)'].split('년')[0]
    except:
        restro_age = ''
    
    try:
        restro_tag_str = restro_tag['특징']
    except:
        restro_tag_str = ""
    try:
        restro_limit_age = int(restro_age)
    except:
        restro_limit_age = 1000

    if restro_limit_age > 2010:
        continue
    
    try:
        tag_list = restro_tag_str.split(',')
    except:
        tag_list = []
    name.append(restro_name)
    menu1.append(restro_menu1)
    menu2.append(restro_menu2)
    tag.append(tag_list)
    address.append(restro_address)
    number.append(restro_number)
    thumbnail.append('')
    location_x.append(restro_location_x)
    location_y.append(restro_location_y)
    resto_age.append(restro_age)
    sectors.append(restro_sectors)

blue_restro_df = pd.DataFrame()
blue_restro_df['resto_age'] = resto_age
blue_restro_df['thumbnail'] = thumbnail
blue_restro_df['address'] = address
blue_restro_df['resto_name'] = name
blue_restro_df['sectors'] = sectors
blue_restro_df['location_x'] = location_x
blue_restro_df['location_y'] = location_y
blue_restro_df['phone_number'] = number
blue_restro_df['menu1'] = menu1
blue_restro_df['menu2'] = menu2
blue_restro_df['tag'] = tag

blue_restro_df.to_csv("blue_restro_df.csv", mode='w', encoding='utf8')
